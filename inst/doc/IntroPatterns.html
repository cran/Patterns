<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2019-11-13" />

<title>Introduction to Patterns: a modeling tool dedicated to biological network modeling</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to Patterns: a modeling tool dedicated to biological network modeling</h1>
<h4 class="author">Frédéric Bertrand and Myriam Maumy-Bertrand</h4>
<address class="author_afil">
Université de Strasbourg et CNRS<br><a class="author_email" href="mailto:#"><a href="mailto:frederic.bertrand@math.unistra.fr" class="email">frederic.bertrand@math.unistra.fr</a></a>
</address>
<h4 class="date">2019-11-13</h4>



<div id="patterns-a-modeling-tool-dedicated-to-biological-network-modeling" class="section level1">
<h1>Patterns: a modeling tool dedicated to biological network modeling</h1>
<p>It allows for <strong>single</strong> or <strong>joint modeling</strong> of, for instance, genes and proteins. It is design to work with <strong>patterned data</strong>. Famous examples of problems related to patterned data are: * recovering <strong>signals</strong> in networks after a <strong>stimulation</strong> (cascade network reverse engineering), * analysing <strong>periodic signals</strong>.</p>
<ul>
<li>It starts with the <strong>selection of the actors</strong> that will be the used in the reverse engineering upcoming step. An actor can be included in that selection based on its <strong>differential effects</strong> (for instance gene expression or protein abundance) or on its <strong>time course profile</strong>.</li>
<li>Wrappers for <strong>actors clustering</strong> functions and cluster analysis are provided.</li>
<li>It also allows <strong>reverse engineering</strong> of biological networks taking into account the observed time course patterns of the actors. Interactions between clusters of actors can be set by the user. Any number of clusters can be activated at a single time.</li>
<li>Many <strong>inference functions</strong> are provided with the <code>Patterns</code> package and dedicated to get <strong>specific features</strong> for the inferred network such as <strong>sparsity</strong>, <strong>robust links</strong>, <strong>high confidence links</strong> or <strong>stable through resampling links</strong>.
<ul>
<li><strong>lasso</strong>, from the <code>lars</code> package</li>
<li><strong>lasso</strong>, from the <code>glmnet</code> package. An unweighted and a weighted version of the algorithm are available</li>
<li><strong>spls</strong>, from the <code>spls</code> package</li>
<li><strong>elasticnet</strong>, from the <code>elasticnet</code> package</li>
<li><strong>stability selection</strong>, from the <code>c060</code> package implementation of stability selection</li>
<li><strong>weighted stability selection</strong>, a new weighted version of the <code>c060</code> package implementation of stability selection that I created for the package</li>
<li><strong>robust</strong>, lasso from the <code>lars</code> package with light random Gaussian noise added to the explanatory variables</li>
<li><strong>selectboost</strong>, from the <code>selectboost</code> package. The selectboost algorithm looks for the more stable links against resampling that takes into account the correlated structure of the predictors</li>
<li><strong>weighted selectboost</strong>, a new weighted version of the <code>selectboost</code>.</li>
</ul></li>
<li>Some <strong>simulation</strong> and <strong>prediction</strong> tools are also available for cascade networks.</li>
<li>Examples of use with microarray or RNA-Seq data are provided.</li>
</ul>
<p>The weights are viewed as a penalty factors in the penalized regression model: it is a number that multiplies the lambda value in the minimization problem to allow differential shrinkage, <a href="https://web.stanford.edu/~hastie/Papers/glmnet.pdf">Friedman et al. 2010</a>, equation 1 page 3. If equal to 0, it implies no shrinkage, and that variable is always included in the model. Default is 1 for all variables. Infinity means that the variable is excluded from the model. Note that the weights are rescaled to sum to the number of variables.</p>
<p>Due to maximum size requirement for CRAN packages, most of the graphics of the vignette will be created when the code is run.</p>
<!-- ![Infered F matrix of the network (General shape).](IntroPatterns_files/figure-html/Fresults-1.png) -->
<!-- ![Infered coefficient matrix of the network (General shape).](IntroPatterns_files/figure-html/heatresults-1.png) -->
<!-- ![Infered F matrix of the network (cascade shape).](IntroPatterns_files/figure-html/FresultsLC-1.png) -->
<!-- ![Infered coefficient matrix of the network (cascade shape).](IntroPatterns_files/figure-html/heatresultsLC-1.png) -->
<!-- ![Reverse-engineered network.](IntroPatterns_files/figure-html/plotnet2-1.png) -->
<!-- ![Evolution of a reverse-engineered network with increasing cut-off values.](IntroPatterns_files/animation.gif) -->
<!-- ![Plot of simulated data for cascade networks featuring cluster membership.](IntroPatterns_files/figure-html/plotsimuldata-1.png) -->
<!-- ![Plot of simulated data for cascade networks featuring subject membership.](IntroPatterns_files/figure-html/plotsimuldata-2.png) -->
<p>A word for those that have been using our seminal work, the <code>Cascade</code> package that we created several years ago and that was a very efficient network reverse engineering tool for cascade networks (Jung, N., Bertrand, F., Bahram, S., Vallat, L., and Maumy-Bertrand, M. (2014), <a href="https://doi.org/10.1093/bioinformatics/btt705" class="uri">https://doi.org/10.1093/bioinformatics/btt705</a>, <a href="https://cran.r-project.org/package=Cascade" class="uri">https://cran.r-project.org/package=Cascade</a>, <a href="https://github.com/fbertran/Cascade" class="uri">https://github.com/fbertran/Cascade</a> and <a href="https://fbertran.github.io/Cascade/" class="uri">https://fbertran.github.io/Cascade/</a>).</p>
<p>The <code>Patterns</code> package is more than (at least) a threeway major extension of the <code>Cascade</code> package :</p>
<ul>
<li><strong>any number of groups</strong> can be used whereas in the <code>Cascade</code> package only 1 group for each timepoint could be created, which prevented the users to create homogeneous clusters of genes in datasets that featured more than a few dozens of genes.</li>
<li><strong>custom</strong> <span class="math inline">\(F\)</span> matrices shapes whereas in the <code>Cascade</code> package only 1 shape was provided:
<ul>
<li>interaction between groups</li>
<li>custom design of inner cells of the <span class="math inline">\(F\)</span> matrix</li>
</ul></li>
<li>the custom <span class="math inline">\(F\)</span> matrices allow to deal with <strong>heteregeneous networks</strong> with several kinds of actors such as mixing genes and proteins in a single network to perform <strong>joint inference</strong>.</li>
<li>about <strong>nine inference algorithms</strong> are provided, whereas 1 (lasso) in <code>Cascade</code>.</li>
</ul>
<p>Hence the <code>Patterns</code> package should be viewed more as a completely new modelling tools than as an extension of the <code>Cascade</code> package.</p>
<p>This website and these examples were created by F. Bertrand and M. Maumy-Bertrand.</p>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>You can install the released version of Patterns from <a href="https://CRAN.R-project.org">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;Patterns&quot;</span>)</a></code></pre></div>
<p>You can install the development version of Patterns from <a href="https://github.com">github</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;fbertran/Patterns&quot;</span>)</a></code></pre></div>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<div id="data-management" class="section level3">
<h3>Data management</h3>
<p>Import Cascade Data (repeated measurements on several subjects) from the CascadeData package and turn them into a micro array object. The second line makes sure the CascadeData package is installed.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">library</span>(Patterns)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(CascadeData)){<span class="kw">install.packages</span>(<span class="st">&quot;CascadeData&quot;</span>)}</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">data</span>(micro_US)</a>
<a class="sourceLine" id="cb3-4" title="4">micro_US&lt;-<span class="kw">as.micro_array</span>(micro_US[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,],<span class="dt">time=</span><span class="kw">c</span>(<span class="dv">60</span>,<span class="dv">90</span>,<span class="dv">210</span>,<span class="dv">390</span>),<span class="dt">subject=</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw">str</span>(micro_US)</a></code></pre></div>
<p>Get a summay and plots of the data:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">summary</span>(micro_US)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">plot</span>(micro_US)</a></code></pre></div>
</div>
<div id="gene-selection" class="section level3">
<h3>Gene selection</h3>
<p>There are several functions to carry out gene selection before the inference. They are detailed in the vignette of the package.</p>
</div>
<div id="data-simulation" class="section level3">
<h3>Data simulation</h3>
<p>Let’s simulate some cascade data and then do some reverse engineering.</p>
<p>We first design the F matrix for <span class="math inline">\(T_i=4\)</span> times and <span class="math inline">\(Ngrp=4\)</span> groups. The <code>Fmat</code>object is an array of sizes <span class="math inline">\((T_i,T-i,Ngrp^2)=(4,4,16)\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">Ti&lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb5-2" title="2">Ngrp&lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb5-3" title="3"></a>
<a class="sourceLine" id="cb5-4" title="4">Fmat=<span class="kw">array</span>(<span class="dv">0</span>,<span class="dt">dim=</span><span class="kw">c</span>(Ti,Ti,Ngrp<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb5-5" title="5"></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(Ti<span class="op">^</span><span class="dv">2</span>)){</a>
<a class="sourceLine" id="cb5-7" title="7">  <span class="cf">if</span>(((i<span class="dv">-1</span>) <span class="op">%%</span><span class="st"> </span>Ti) <span class="op">&gt;</span><span class="st"> </span>(i<span class="dv">-1</span>) <span class="op">%/%</span><span class="st"> </span>Ti){</a>
<a class="sourceLine" id="cb5-8" title="8">    Fmat[,,i][<span class="kw">outer</span>(<span class="dv">1</span><span class="op">:</span>Ti,<span class="dv">1</span><span class="op">:</span>Ti,<span class="cf">function</span>(x,y){<span class="dv">0</span><span class="op">&lt;</span>(x<span class="op">-</span>y) <span class="op">&amp;</span><span class="st"> </span>(x<span class="op">-</span>y)<span class="op">&lt;</span><span class="dv">2</span>})]&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb5-9" title="9">    }</a>
<a class="sourceLine" id="cb5-10" title="10">}</a></code></pre></div>
<p>The <code>Patterns</code> function <code>CascadeFinit</code> is an utility function to easily define such an F matrix.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">Fbis=Patterns<span class="op">::</span><span class="kw">CascadeFinit</span>(Ti,Ngrp,<span class="dt">low.trig=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">str</span>(Fbis)</a></code></pre></div>
<p>Check if the two matrices <code>Fmat</code> and <code>Fbis</code> are identical.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">print</span>(<span class="kw">all</span>(Fmat<span class="op">==</span>Fbis))</a></code></pre></div>
<p>End of F matrix definition.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">Fmat[,,<span class="dv">3</span>]&lt;-Fmat[,,<span class="dv">3</span>]<span class="op">*</span><span class="fl">0.2</span></a>
<a class="sourceLine" id="cb8-2" title="2">Fmat[<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>]&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb8-3" title="3">Fmat[<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>]&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb8-4" title="4">Fmat[,,<span class="dv">4</span>]&lt;-Fmat[,,<span class="dv">3</span>]<span class="op">*</span><span class="fl">0.3</span></a>
<a class="sourceLine" id="cb8-5" title="5">Fmat[<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>]&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb8-6" title="6">Fmat[,,<span class="dv">8</span>]&lt;-Fmat[,,<span class="dv">3</span>]</a></code></pre></div>
<p>We set the seed to make the results reproducible and draw a scale free random network.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">Net&lt;-Patterns<span class="op">::</span><span class="kw">network_random</span>(</a>
<a class="sourceLine" id="cb9-3" title="3">  <span class="dt">nb=</span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb9-4" title="4">  <span class="dt">time_label=</span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dt">each=</span><span class="dv">25</span>),</a>
<a class="sourceLine" id="cb9-5" title="5">  <span class="dt">exp=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb9-6" title="6">  <span class="dt">init=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb9-7" title="7">  <span class="dt">regul=</span><span class="kw">round</span>(<span class="kw">rexp</span>(<span class="dv">100</span>,<span class="dv">1</span>))<span class="op">+</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb9-8" title="8">  <span class="dt">min_expr=</span><span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb9-9" title="9">  <span class="dt">max_expr=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb9-10" title="10">  <span class="dt">casc.level=</span><span class="fl">0.4</span></a>
<a class="sourceLine" id="cb9-11" title="11">)</a>
<a class="sourceLine" id="cb9-12" title="12">Net<span class="op">@</span>F&lt;-Fmat</a>
<a class="sourceLine" id="cb9-13" title="13"><span class="kw">str</span>(Net)</a></code></pre></div>
<p>Plot the simulated network.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">Patterns<span class="op">::</span><span class="kw">plot</span>(Net, <span class="dt">choice=</span><span class="st">&quot;network&quot;</span>)</a></code></pre></div>
<p>If a gene clustering is known, it can be used as a coloring scheme.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">plot</span>(Net, <span class="dt">choice=</span><span class="st">&quot;network&quot;</span>, <span class="dt">gr=</span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dt">each=</span><span class="dv">25</span>))</a></code></pre></div>
<p>Plot the F matrix, for low dimensional F matrices.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">plot</span>(Net, <span class="dt">choice=</span><span class="st">&quot;F&quot;</span>)</a></code></pre></div>
<p>Plot the F matrix using the <code>pixmap</code> package, for high dimensional F matrices.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">plot</span>(Net, <span class="dt">choice=</span><span class="st">&quot;Fpixmap&quot;</span>)</a></code></pre></div>
<p>We simulate gene expression according to the network that was previously drawn</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb14-2" title="2">M &lt;-<span class="st"> </span>Patterns<span class="op">::</span><span class="kw">gene_expr_simulation</span>(</a>
<a class="sourceLine" id="cb14-3" title="3">  <span class="dt">network=</span>Net,</a>
<a class="sourceLine" id="cb14-4" title="4">  <span class="dt">time_label=</span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dt">each=</span><span class="dv">25</span>),</a>
<a class="sourceLine" id="cb14-5" title="5">  <span class="dt">subject=</span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb14-6" title="6">  <span class="dt">peak_level=</span><span class="dv">200</span>,</a>
<a class="sourceLine" id="cb14-7" title="7">  <span class="dt">act_time_group=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb14-8" title="8"><span class="kw">str</span>(M)</a></code></pre></div>
<p>Get a summay and plots of the simulated data:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">summary</span>(M)</a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">plot</span>(M)</a></code></pre></div>
</div>
<div id="network-inferrence" class="section level3">
<h3>Network inferrence</h3>
<p>We infer the new network using subjectwise leave one out cross-validation (default setting): all measurements from the same subject are removed from the dataset). The inference is carried out with a general Fshape.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">Net_inf_P &lt;-<span class="st"> </span>Patterns<span class="op">::</span><span class="kw">inference</span>(M, <span class="dt">cv.subjects=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">plot</span>(Net_inf_P, <span class="dt">choice=</span><span class="st">&quot;F&quot;</span>)</a></code></pre></div>
<p>Heatmap of the inferred coefficients of the Omega matrix</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">stats<span class="op">::</span><span class="kw">heatmap</span>(Net_inf_P<span class="op">@</span>network, <span class="dt">Rowv =</span> <span class="ot">NA</span>, <span class="dt">Colv =</span> <span class="ot">NA</span>, <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">revC=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>Default values fot the <span class="math inline">\(F\)</span> matrices. The <code>Finit</code> matrix (starting values for the algorithm). In our case, the <code>Finit</code>object is an array of sizes <span class="math inline">\((T_i,T-i,Ngrp^2)=(4,4,16)\)</span>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">Ti&lt;-<span class="dv">4</span>;</a>
<a class="sourceLine" id="cb20-2" title="2">ngrp&lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb20-3" title="3">nF&lt;-ngrp<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb20-4" title="4">Finit&lt;-<span class="kw">array</span>(<span class="dv">0</span>,<span class="kw">c</span>(Ti,Ti,nF)) </a>
<a class="sourceLine" id="cb20-5" title="5">              <span class="cf">for</span>(ii <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nF){    </a>
<a class="sourceLine" id="cb20-6" title="6">                <span class="cf">if</span>((ii<span class="op">%%</span>(ngrp<span class="op">+</span><span class="dv">1</span>))<span class="op">==</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb20-7" title="7">                  Finit[,,ii]&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb20-8" title="8">                } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb20-9" title="9">                  Finit[,,ii]&lt;-<span class="kw">cbind</span>(<span class="kw">rbind</span>(<span class="kw">rep</span>(<span class="dv">0</span>,Ti<span class="dv">-1</span>),<span class="kw">diag</span>(<span class="dv">1</span>,Ti<span class="dv">-1</span>)),<span class="kw">rep</span>(<span class="dv">0</span>,Ti))<span class="op">+</span><span class="kw">rbind</span>(<span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="dv">0</span>,Ti<span class="dv">-1</span>),<span class="kw">diag</span>(<span class="dv">1</span>,Ti<span class="dv">-1</span>)),<span class="kw">rep</span>(<span class="dv">0</span>,Ti))</a>
<a class="sourceLine" id="cb20-10" title="10">                }</a>
<a class="sourceLine" id="cb20-11" title="11">              }</a></code></pre></div>
<p>The <code>Fshape</code> matrix (default shape for <code>F</code> matrix the algorithm). Any interaction between groups and times are permitted except the retro-actions (a group on itself, or an action at the same time for an actor on another one).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">Fshape&lt;-<span class="kw">array</span>(<span class="st">&quot;0&quot;</span>,<span class="kw">c</span>(Ti,Ti,nF)) </a>
<a class="sourceLine" id="cb21-2" title="2"><span class="cf">for</span>(ii <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nF){  </a>
<a class="sourceLine" id="cb21-3" title="3">  <span class="cf">if</span>((ii<span class="op">%%</span>(ngrp<span class="op">+</span><span class="dv">1</span>))<span class="op">==</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb21-4" title="4">    Fshape[,,ii]&lt;-<span class="st">&quot;0&quot;</span></a>
<a class="sourceLine" id="cb21-5" title="5">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb21-6" title="6">    lchars &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;a&quot;</span>,<span class="dv">1</span><span class="op">:</span>(<span class="dv">2</span><span class="op">*</span>Ti<span class="dv">-1</span>),<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb21-7" title="7">    tempFshape&lt;-<span class="kw">matrix</span>(<span class="st">&quot;0&quot;</span>,Ti,Ti)</a>
<a class="sourceLine" id="cb21-8" title="8">    <span class="cf">for</span>(bb <span class="cf">in</span> (<span class="op">-</span>Ti<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(Ti<span class="dv">-1</span>)){</a>
<a class="sourceLine" id="cb21-9" title="9">      tempFshape&lt;-<span class="kw">replaceUp</span>(tempFshape,<span class="kw">matrix</span>(lchars[bb<span class="op">+</span>Ti],Ti,Ti),<span class="op">-</span>bb)</a>
<a class="sourceLine" id="cb21-10" title="10">    }</a>
<a class="sourceLine" id="cb21-11" title="11">    tempFshape &lt;-<span class="st"> </span><span class="kw">replaceBand</span>(tempFshape,<span class="kw">matrix</span>(<span class="st">&quot;0&quot;</span>,Ti,Ti),<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb21-12" title="12">    Fshape[,,ii]&lt;-tempFshape</a>
<a class="sourceLine" id="cb21-13" title="13">  }</a>
<a class="sourceLine" id="cb21-14" title="14">}</a></code></pre></div>
<p>Any other form can be used. A “0” coefficient is missing from the model. It allows testing the best structure of an “F” matrix and even performing some significance tests of hypothses on the structure of the <span class="math inline">\(F\)</span> matrix.</p>
<p>The <code>IndicFshape</code> function allows to design custom F matrix for cascade networks with equally spaced measurements by specifying the zero and non zero <span class="math inline">\(F_{ij}\)</span> cells of the <span class="math inline">\(F\)</span> matrix. It is useful for models featuring several clusters of actors that are activated at the time. Let’s define the following indicatrix matrix (action of all groups on each other, which is not a possible real modeling setting and is only used as an example):</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">TestIndic=<span class="kw">matrix</span>(<span class="op">!</span>((<span class="dv">1</span><span class="op">:</span>(Ti<span class="op">^</span><span class="dv">2</span>))<span class="op">%%</span>(ngrp<span class="op">+</span><span class="dv">1</span>)<span class="op">==</span><span class="dv">1</span>),<span class="dt">byrow=</span><span class="ot">TRUE</span>,ngrp,ngrp)</a>
<a class="sourceLine" id="cb22-2" title="2">TestIndic</a></code></pre></div>
<p>For that choice, we get those init and shape <span class="math inline">\(F\)</span> matrices.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">IndicFinit</span>(Ti,ngrp,TestIndic)</a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw">IndicFshape</span>(Ti,ngrp,TestIndic)</a></code></pre></div>
<p>Those <span class="math inline">\(F\)</span> matrices are lower diagonal ones to enforce that an observed value at a given time can only be predicted by a value that was observed in the past only (i.e. neither at the same moment or in the future).</p>
<p>The <code>plotF</code> is convenient to display F matrices. Here are the the displays of the three <span class="math inline">\(F\)</span> matrices we have just introduced.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">plotF</span>(Fshape,<span class="dt">choice=</span><span class="st">&quot;Fshape&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">plotF</span>(<span class="kw">CascadeFshape</span>(<span class="dv">4</span>,<span class="dv">4</span>),<span class="dt">choice=</span><span class="st">&quot;Fshape&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">plotF</span>(<span class="kw">IndicFshape</span>(Ti,ngrp,TestIndic),<span class="dt">choice=</span><span class="st">&quot;Fshape&quot;</span>)</a></code></pre></div>
<p>We now fit the model with an <span class="math inline">\(F\)</span> matrix that is designed for cascade networks.</p>
<p>Specific Fshape</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">Net_inf_P_S &lt;-<span class="st"> </span>Patterns<span class="op">::</span><span class="kw">inference</span>(M, <span class="dt">Finit=</span><span class="kw">CascadeFinit</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">Fshape=</span><span class="kw">CascadeFshape</span>(<span class="dv">4</span>,<span class="dv">4</span>))</a></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">plot</span>(Net_inf_P_S, <span class="dt">choice=</span><span class="st">&quot;F&quot;</span>)</a></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network. They reflect the use of a special <span class="math inline">\(F\)</span> matrix. It is an example of an F matrix specifically designed to deal with cascade networks.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">stats<span class="op">::</span><span class="kw">heatmap</span>(Net_inf_P_S<span class="op">@</span>network, <span class="dt">Rowv =</span> <span class="ot">NA</span>, <span class="dt">Colv =</span> <span class="ot">NA</span>, <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">revC=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>There are many fitting functions provided with the <code>Patterns</code> package in order to search for <strong>specific features</strong> for the inferred network such as <strong>sparsity</strong>, <strong>robust links</strong>, <strong>high confidence links</strong> or <strong>stable through resampling links</strong>. :</p>
<ul>
<li><strong>LASSO</strong>, from the <code>lars</code> package</li>
<li><strong>LASSO2</strong>, from the <code>glmnet</code> package. An unweighted and a weighted version of the algorithm are available</li>
<li><strong>SPLS</strong>, from the <code>spls</code> package</li>
<li><strong>ELASTICNET</strong>, from the <code>elasticnet</code> package</li>
<li><strong>stability.c060</strong>, from the <code>c060</code> package implementation of stability selection</li>
<li><strong>stability.c060.weighted</strong>, a new weighted version of the <code>c060</code> package implementation of stability selection</li>
<li><strong>robust</strong>, lasso from the <code>lars</code> package with light random Gaussian noise added to the explanatory variables</li>
<li><strong>selectboost.weighted</strong>, a new weighted version of the <code>selectboost</code> package implementation of the selectboost algorithm to look for the more stable links against resampling that takes into account the correlated structure of the predictors. If no weights are provided, equal weigths are for all the variables (=non weighted case).</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">Net_inf_P_Lasso2 &lt;-<span class="st"> </span>Patterns<span class="op">::</span><span class="kw">inference</span>(M, <span class="dt">Finit=</span><span class="kw">CascadeFinit</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">Fshape=</span><span class="kw">CascadeFshape</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">fitfun=</span><span class="st">&quot;LASSO2&quot;</span>)</a></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">plot</span>(Net_inf_P_Lasso2, <span class="dt">choice=</span><span class="st">&quot;F&quot;</span>)</a></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">stats<span class="op">::</span><span class="kw">heatmap</span>(Net_inf_P_Lasso2<span class="op">@</span>network, <span class="dt">Rowv =</span> <span class="ot">NA</span>, <span class="dt">Colv =</span> <span class="ot">NA</span>, <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">revC=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>We create a weighting vector to perform weighted lasso inference.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">Weights_Net=<span class="kw">slot</span>(Net,<span class="st">&quot;network&quot;</span>)</a>
<a class="sourceLine" id="cb33-2" title="2">Weights_Net[Net<span class="op">@</span>network<span class="op">!=</span><span class="dv">0</span>]=.<span class="dv">1</span>        </a>
<a class="sourceLine" id="cb33-3" title="3">Weights_Net[Net<span class="op">@</span>network<span class="op">==</span><span class="dv">0</span>]=<span class="dv">1000</span></a></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">Net_inf_P_Lasso2_Weighted &lt;-<span class="st"> </span>Patterns<span class="op">::</span><span class="kw">inference</span>(M, <span class="dt">Finit=</span><span class="kw">CascadeFinit</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">Fshape=</span><span class="kw">CascadeFshape</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">fitfun=</span><span class="st">&quot;LASSO2&quot;</span>, <span class="dt">priors=</span>Weights_Net)</a></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">plot</span>(Net_inf_P_Lasso2_Weighted, <span class="dt">choice=</span><span class="st">&quot;F&quot;</span>)</a></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">stats<span class="op">::</span><span class="kw">heatmap</span>(Net_inf_P_Lasso2_Weighted<span class="op">@</span>network, <span class="dt">Rowv =</span> <span class="ot">NA</span>, <span class="dt">Colv =</span> <span class="ot">NA</span>, <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">revC=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">Net_inf_P_SPLS &lt;-<span class="st"> </span>Patterns<span class="op">::</span><span class="kw">inference</span>(M, <span class="dt">Finit=</span><span class="kw">CascadeFinit</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">Fshape=</span><span class="kw">CascadeFshape</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">fitfun=</span><span class="st">&quot;SPLS&quot;</span>)</a></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">plot</span>(Net_inf_P_SPLS, <span class="dt">choice=</span><span class="st">&quot;F&quot;</span>)</a></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">stats<span class="op">::</span><span class="kw">heatmap</span>(Net_inf_P_SPLS<span class="op">@</span>network, <span class="dt">Rowv =</span> <span class="ot">NA</span>, <span class="dt">Colv =</span> <span class="ot">NA</span>, <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">revC=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">Net_inf_P_ELASTICNET &lt;-<span class="st"> </span>Patterns<span class="op">::</span><span class="kw">inference</span>(M, <span class="dt">Finit=</span><span class="kw">CascadeFinit</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">Fshape=</span><span class="kw">CascadeFshape</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">fitfun=</span><span class="st">&quot;ELASTICNET&quot;</span>)</a></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">plot</span>(Net_inf_P_ELASTICNET, <span class="dt">choice=</span><span class="st">&quot;F&quot;</span>)</a></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">stats<span class="op">::</span><span class="kw">heatmap</span>(Net_inf_P_ELASTICNET<span class="op">@</span>network, <span class="dt">Rowv =</span> <span class="ot">NA</span>, <span class="dt">Colv =</span> <span class="ot">NA</span>, <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">revC=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">Net_inf_P_stability &lt;-<span class="st"> </span>Patterns<span class="op">::</span><span class="kw">inference</span>(M, <span class="dt">Finit=</span><span class="kw">CascadeFinit</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">Fshape=</span><span class="kw">CascadeFshape</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">fitfun=</span><span class="st">&quot;stability.c060&quot;</span>)</a></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">plot</span>(Net_inf_P_stability, <span class="dt">choice=</span><span class="st">&quot;F&quot;</span>)</a></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">stats<span class="op">::</span><span class="kw">heatmap</span>(Net_inf_P_stability<span class="op">@</span>network, <span class="dt">Rowv =</span> <span class="ot">NA</span>, <span class="dt">Colv =</span> <span class="ot">NA</span>, <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">revC=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">Net_inf_P_StabWeight &lt;-<span class="st"> </span>Patterns<span class="op">::</span><span class="kw">inference</span>(M, <span class="dt">Finit=</span><span class="kw">CascadeFinit</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">Fshape=</span><span class="kw">CascadeFshape</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">fitfun=</span><span class="st">&quot;stability.c060.weighted&quot;</span>, <span class="dt">priors=</span>Weights_Net)</a></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">plot</span>(Net_inf_P_StabWeight, <span class="dt">choice=</span><span class="st">&quot;F&quot;</span>)</a></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">stats<span class="op">::</span><span class="kw">heatmap</span>(Net_inf_P_StabWeight<span class="op">@</span>network, <span class="dt">Rowv =</span> <span class="ot">NA</span>, <span class="dt">Colv =</span> <span class="ot">NA</span>, <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">revC=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">Net_inf_P_Robust &lt;-<span class="st"> </span>Patterns<span class="op">::</span><span class="kw">inference</span>(M, <span class="dt">Finit=</span><span class="kw">CascadeFinit</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">Fshape=</span><span class="kw">CascadeFshape</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">fitfun=</span><span class="st">&quot;robust&quot;</span>)</a></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">plot</span>(Net_inf_P_Robust, <span class="dt">choice=</span><span class="st">&quot;F&quot;</span>)</a></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">stats<span class="op">::</span><span class="kw">heatmap</span>(Net_inf_P_Robust<span class="op">@</span>network, <span class="dt">Rowv =</span> <span class="ot">NA</span>, <span class="dt">Colv =</span> <span class="ot">NA</span>, <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">revC=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">Weights_Net_<span class="dv">1</span> &lt;-<span class="st"> </span>Weights_Net</a>
<a class="sourceLine" id="cb52-2" title="2">Weights_Net_<span class="dv">1</span>[,] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb52-3" title="3">Net_inf_P_SelectBoost &lt;-<span class="st"> </span>Patterns<span class="op">::</span><span class="kw">inference</span>(M, <span class="dt">Finit=</span><span class="kw">CascadeFinit</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">Fshape=</span><span class="kw">CascadeFshape</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">fitfun=</span><span class="st">&quot;selectboost.weighted&quot;</span>,<span class="dt">priors=</span>Weights_Net_<span class="dv">1</span>)</a></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="kw">detach</span>(<span class="st">&quot;package:Patterns&quot;</span>, <span class="dt">unload=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb53-2" title="2"><span class="kw">library</span>(Patterns)</a></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">plot</span>(Net_inf_P_SelectBoost, <span class="dt">choice=</span><span class="st">&quot;F&quot;</span>)</a></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">stats<span class="op">::</span><span class="kw">heatmap</span>(Net_inf_P_SelectBoost<span class="op">@</span>network, <span class="dt">Rowv =</span> <span class="ot">NA</span>, <span class="dt">Colv =</span> <span class="ot">NA</span>, <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">revC=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">Net_inf_P_SelectBoostWeighted &lt;-<span class="st"> </span>Patterns<span class="op">::</span><span class="kw">inference</span>(M, <span class="dt">Finit=</span><span class="kw">CascadeFinit</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">Fshape=</span><span class="kw">CascadeFshape</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">fitfun=</span><span class="st">&quot;selectboost.weighted&quot;</span>,<span class="dt">priors=</span>Weights_Net)</a></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">detach</span>(<span class="st">&quot;package:Patterns&quot;</span>, <span class="dt">unload=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb57-2" title="2"><span class="kw">library</span>(Patterns)</a></code></pre></div>
<p>Plot of the inferred F matrix</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="kw">plot</span>(Net_inf_P_SelectBoostWeighted, <span class="dt">choice=</span><span class="st">&quot;F&quot;</span>)</a></code></pre></div>
<p>Heatmap of the coefficients of the Omega matrix of the network</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1">stats<span class="op">::</span><span class="kw">heatmap</span>(Net_inf_P_SelectBoostWeighted<span class="op">@</span>network, <span class="dt">Rowv =</span> <span class="ot">NA</span>, <span class="dt">Colv =</span> <span class="ot">NA</span>, <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">revC=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>###Post inference network analysis Such an analysis is only required if the model was not fitted using the stability selection or the selectboost algorithm.</p>
<p>Create an animation of the network with increasing cutoffs with an animated .gif format or a html webpage. See the the <a href="https://github.com/fbertran/Patterns">webpage of the <code>Patterns</code> package</a> for the animation results at the .gif and .html formats.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">data</span>(network)</a>
<a class="sourceLine" id="cb60-2" title="2">sequence&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">0.2</span>,<span class="dt">length.out=</span><span class="dv">20</span>)</a>
<a class="sourceLine" id="cb60-3" title="3"><span class="kw">evolution</span>(network,sequence,<span class="dt">type.ani =</span> <span class="st">&quot;gif&quot;</span>)</a>
<a class="sourceLine" id="cb60-4" title="4"><span class="kw">evolution</span>(network,sequence,<span class="dt">type.ani =</span> <span class="st">&quot;html&quot;</span>)</a></code></pre></div>
<p>Evolution of some properties of a reverse-engineered network with increasing cut-off values.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">data</span>(Net)</a>
<a class="sourceLine" id="cb61-2" title="2"><span class="kw">data</span>(Net_inf_PL)</a>
<a class="sourceLine" id="cb61-3" title="3"></a>
<a class="sourceLine" id="cb61-4" title="4"><span class="co">#Comparing true and inferred networks</span></a>
<a class="sourceLine" id="cb61-5" title="5">Crit_values=<span class="ot">NULL</span></a>
<a class="sourceLine" id="cb61-6" title="6"></a>
<a class="sourceLine" id="cb61-7" title="7"><span class="co">#Here are the cutoff level tested</span></a>
<a class="sourceLine" id="cb61-8" title="8">test.seq&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">max</span>(<span class="kw">abs</span>(Net_inf_PL<span class="op">@</span>network<span class="op">*</span><span class="fl">0.9</span>)),<span class="dt">length.out=</span><span class="dv">200</span>)</a>
<a class="sourceLine" id="cb61-9" title="9"><span class="cf">for</span>(u <span class="cf">in</span> test.seq){</a>
<a class="sourceLine" id="cb61-10" title="10">    Crit_values&lt;-<span class="kw">rbind</span>(Crit_values,Patterns<span class="op">::</span><span class="kw">compare</span>(Net,Net_inf_PL,u))</a>
<a class="sourceLine" id="cb61-11" title="11">}</a>
<a class="sourceLine" id="cb61-12" title="12"><span class="kw">matplot</span>(test.seq,Crit_values,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Criterion value&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;Cutoff level&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb61-13" title="13"><span class="kw">legend</span>(<span class="dt">x=</span><span class="st">&quot;topleft&quot;</span>, <span class="dt">legend=</span><span class="kw">colnames</span>(Crit_values), <span class="dt">lty=</span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">cex=</span>.<span class="dv">9</span>)</a></code></pre></div>
<p>We switch to data that were derived from the inferrence of a real biological network and try to detect the optimal cutoff value: the best cutoff value for a network to fit a scale free network. The <code>cutoff</code> was validated only single group cascade networks (number of actors groups = number of timepoints) and for genes dataset. Instead of the <code>cutoff</code> function, manual curation or the stability selection or the selectboost algorithm should be used.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="kw">data</span>(<span class="st">&quot;networkCascade&quot;</span>)</a>
<a class="sourceLine" id="cb62-2" title="2"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb62-3" title="3"><span class="kw">cutoff</span>(networkCascade)</a></code></pre></div>
<p>Analyze the network with a cutoff set to the previouly found 0.133 optimal value.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">analyze_network</span>(networkCascade,<span class="dt">nv=</span><span class="fl">0.133</span>)</a></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="kw">data</span>(Selection)</a>
<a class="sourceLine" id="cb64-2" title="2"><span class="kw">plot</span>(networkCascade,<span class="dt">nv=</span><span class="fl">0.133</span>, <span class="dt">gr=</span>Selection<span class="op">@</span>group)</a></code></pre></div>
</div>
<div id="perform-gene-selection" class="section level3">
<h3>Perform gene selection</h3>
<p>Import data.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">library</span>(Patterns)</a>
<a class="sourceLine" id="cb65-2" title="2"><span class="kw">library</span>(CascadeData)</a>
<a class="sourceLine" id="cb65-3" title="3"><span class="kw">data</span>(micro_S)</a>
<a class="sourceLine" id="cb65-4" title="4">micro_S&lt;-<span class="kw">as.micro_array</span>(micro_S,<span class="dt">time=</span><span class="kw">c</span>(<span class="dv">60</span>,<span class="dv">90</span>,<span class="dv">210</span>,<span class="dv">390</span>),<span class="dt">subject=</span><span class="dv">6</span>,<span class="dt">gene_ID=</span><span class="kw">rownames</span>(micro_S))</a>
<a class="sourceLine" id="cb65-5" title="5"><span class="kw">data</span>(micro_US)</a>
<a class="sourceLine" id="cb65-6" title="6">micro_US&lt;-<span class="kw">as.micro_array</span>(micro_US,<span class="dt">time=</span><span class="kw">c</span>(<span class="dv">60</span>,<span class="dv">90</span>,<span class="dv">210</span>,<span class="dv">390</span>),<span class="dt">subject=</span><span class="dv">6</span>,<span class="dt">gene_ID=</span><span class="kw">rownames</span>(micro_US))</a></code></pre></div>
<p>Select early genes (t1 or t2):</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">Selection1&lt;-Patterns<span class="op">::</span><span class="kw">geneSelection</span>(<span class="dt">x=</span>micro_S,<span class="dt">y=</span>micro_US,<span class="dv">20</span>,<span class="dt">wanted.patterns=</span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)))</a></code></pre></div>
<p>Section genes with first significant differential expression at t1:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">Selection2&lt;-<span class="kw">geneSelection</span>(<span class="dt">x=</span>micro_S,<span class="dt">y=</span>micro_US,<span class="dv">20</span>,<span class="dt">peak=</span><span class="dv">1</span>)</a></code></pre></div>
<p>Section genes with first significant differential expression at t2:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">Selection3&lt;-<span class="kw">geneSelection</span>(<span class="dt">x=</span>micro_S,<span class="dt">y=</span>micro_US,<span class="dv">20</span>,<span class="dt">peak=</span><span class="dv">2</span>)</a></code></pre></div>
<p>Select later genes (t3 or t4)</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1">Selection4&lt;-<span class="kw">geneSelection</span>(<span class="dt">x=</span>micro_S,<span class="dt">y=</span>micro_US,<span class="dv">50</span>,</a>
<a class="sourceLine" id="cb69-2" title="2"><span class="dt">wanted.patterns=</span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)))</a></code></pre></div>
<p>Merge those selections:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">Selection&lt;-<span class="kw">unionMicro</span>(Selection1,Selection2)</a>
<a class="sourceLine" id="cb70-2" title="2">Selection&lt;-<span class="kw">unionMicro</span>(Selection,Selection3)</a>
<a class="sourceLine" id="cb70-3" title="3">Selection&lt;-<span class="kw">unionMicro</span>(Selection,Selection4)</a>
<a class="sourceLine" id="cb70-4" title="4"><span class="kw">head</span>(Selection)</a></code></pre></div>
<p>Summarize the final selection:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">summary</span>(Selection)</a></code></pre></div>
<p>Plot the final selection:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="kw">plot</span>(Selection)</a></code></pre></div>
<p>This process could be improved by retrieve a real gene_ID using the <code>bitr</code> function of the <code>ClusterProfiler</code> package or by performing independent filtering using <code>jetset</code> package to only keep at most only probeset (the best one, if there is one good enough) per gene_ID.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
